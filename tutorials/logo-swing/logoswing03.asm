!to "build/logoswing3.prg",cbm
!src "standart.asm"

	;----------------------------------------
	;CONSTANTS
	;----------------------------------------
	
	SCREEN_RAM = $0400
	EFFECT_COUNTER = $02
	EFFECT_COUNTER2 = $03
	CHAR_OFFSET = $04
	PIXEL_OFFSET_H = $05
	PIXEL_OFFSET_V = $06

	+BASIC_START

	;-----------------------------------------
	; MAIN
	;-----------------------------------------
	
	* = $c000

	+CLEAR_SCREEN
	
	lda #00
	sta $d020
	sta $d021
	
	;Set raster irq
 	sei

	lda #$7f	;Disable CIA I and CIA II interrupts
	sta $dc0d

	lda $d01a	;Enable raster interrupts
	ora #$01
	sta $d01a

	lda #$00
	sta $dc0e
	
	lda #160 	;set raster line
	sta $d012
	lda $d011
	and #$7f 	;%01111111
    	sta $d011
		
	lda #<irq 	;set interrupt handler
	sta $0314
	lda #>irq
	sta $0315
 
    	cli
    	
    	jmp *
        	
        	;-----------------------------------------------------
        	; IRQ ROUTINE
        	;-----------------------------------------------------

irq 	inc EFFECT_COUNTER 	;increase effect counter
	ldx EFFECT_COUNTER 	;and grab swing data
	Lda swing_data,x
	
	lsr 		;Divide by 8 and
	lsr 		;store as char ofsset
	lsr
	sta CHAR_OFFSET
	
	lda swing_data,x
	and #$07
	sta PIXEL_OFFSET_H
	
	inc EFFECT_COUNTER2 	;increase effect counter 2 		;till 31
	lda EFFECT_COUNTER2
	and #$1f 		;(%00011111)
	sta EFFECT_COUNTER2
	
	ldx EFFECT_COUNTER2
	lda swing_data2,x
	sta PIXEL_OFFSET_V
	
	jsr updateLogo
	
	asl $d019			
	jmp $ea81		

updateLogo	
!zone {	;Pixel Scroll Horizontal
	lda PIXEL_OFFSET_H
	and #$07 	;%00000111
	sta $d016
	
	;Pixel Scroll Vertical
	lda $d011
	and #$78 	;%1111000
	ora PIXEL_OFFSET_V
	sta $d011
	
	;Char Scroll
	ldx CHAR_OFFSET
	ldy #00
-	lda logo,y
	sta SCREEN_RAM+40*5,x
	lda logo+160,y
	sta SCREEN_RAM+40*9,x
	inx
	iny
	cpx #160
	bne - 
	
	rts
}	

	;------------------------------------------------------
	; DATA
	;------------------------------------------------------
	
logo	!by 32,32,85,64,73,85,64,64,73,85,64,73,85,64,64,64,64,64,73,85,64,73,85,64,64,73,85,64,73,32,32,32,32,32,32,32,32,32,32,32
	!by 32,32,194,224,194,194,224,224,194,194,224,194,194,224,224,224,224,224,194,194,224,194,194,224,224,194,194,224,194,32,32,32,32,32,32,32,32,32,32,32
	!by 32,32,194,206,194,194,224,224,194,194,206,194,202,192,192,206,224,206,203,194,206,194,194,224,224,194,194,206,194,32,32,32,32,32,32,32,32,32,32,32
	!by 32,32,194,206,194,194,224,224,194,194,206,194,224,224,206,224,206,224,224,194,206,194,194,224,224,194,194,206,194,32,32,32,32,32,32,32,32,32,32,32
	!by 32,32,194,206,202,203,213,201,202,203,206,194,213,206,224,224,237,192,201,194,206,202,203,213,201,202,203,206,194,32,32,32,32,32,32,32,32,32,32,32
	!by 32,32,194,224,224,224,194,194,224,224,224,194,194,224,224,224,224,224,194,194,224,224,224,194,194,224,224,224,194,32,32,32,32,32,32,32,32,32,32,32
	!by 32,32,74,64,64,64,75,74,64,64,64,75,74,64,64,64,64,64,75,74,64,64,64,75,74,64,64,64,75,32,32,32,32,32,32,32,32,32,32,32,32
	!scr "  logo  swing  by  wizofwor             "

swing_data  !by 32,33,34,34,35,36,37,37,38,39,40,41,41,42,43,44,44,45,46,46
	!by 47,48,49,49,50,50,51,52,52,53,54,54,55,55,56,56,57,57,58,58
	!by 59,59,60,60,60,61,61,61,62,62,62,62,63,63,63,63,63,64,64,64
	!by 64,64,64,64,64,64,64,64,64,64,64,63,63,63,63,63,63,62,62,62
	!by 61,61,61,60,60,60,59,59,58,58,58,57,57,56,56,55,54,54,53,53
	!by 52,51,51,50,50,49,48,47,47,46,45,45,44,43,42,42,41,40,39,39
	!by 38,37,36,36,35,34,33,32,32,31,30,29,28,28,27,26,25,25,24,23
	!by 22,22,21,20,19,19,18,17,17,16,15,14,14,13,13,12,11,11,10,10
	!by 9,8,8,7,7,6,6,6,5,5,4,4,4,3,3,3,2,2,2,1
	!by 1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
	!by 1,1,1,1,2,2,2,2,3,3,3,4,4,4,5,5,6,6,7,7
	!by 8,8,9,9,10,10,11,12,12,13,14,14,15,15,16,17,18,18,19,20
	!by 20,21,22,23,23,24,25,26,27,27,28,29,30,30,31,32

swing_data2 !by 4,4,5,6,6,7,7,7,7,7,7,6,6,5,4,4,3,2,1,1,0,0,0,0,0,0,1,1,2,3,4,4

	
	